<script type="text/javascript">
    window.thingjsValueStringify = function (value, type) {
        switch (type) {
            case 'msg':
                return `$i[${JSON.stringify(value)}]`;
            case 'flow':
                return `this.$c[${JSON.stringify(value)}]`;
            case 'global':
                return `$g[${JSON.stringify(value)}]`;
            case 'num':
                return JSON.stringify(1 * value);
            case 'bool':
                return JSON.stringify(!!value);
            case 'json':
                return value;
            case 'bin':
                var bin = value;
                try {
                    bin = JSON.parse(value);
                    return '"' + (bin && bin.length ? '\\x' : '') + bin.map((item) => {
                        return item.toString(16);
                    }).join('\\x') + '"';
                } catch(e) {
                    return '"' + (bin && bin.length ? '\\x' : '') + value.split("").map((item) => {
                        return item.charCodeAt(0).toString(16);
                    }).join('\\x') + '"';
                }
                break;
            default:
                return JSON.stringify(value);
        }
    };
</script>